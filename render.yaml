services:
  - type: web
    name: rag-backend
    runtime: node
    buildCommand: pnpm install && pnpm build
    startCommand: pnpm start:prod
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: $PORT
      - key: GROQ_API_KEY
        value: $GROQ_API_KEY
      - key: GROQ_MODEL
        value: $GROQ_MODEL
      - key: PINECONE_API_KEY
        value: $PINECONE_API_KEY
      - key: PINECONE_ENVIRONMENT
        value: $PINECONE_ENVIRONMENT
      - key: PINECONE_INDEX_NAME
        value: $PINECONE_INDEX_NAME
      - key: RAG_DEFAULT_INSTRUCTIONS
        value: $RAG_DEFAULT_INSTRUCTIONS
      - key: RAG_MAX_HISTORY_LENGTH
        value: $RAG_MAX_HISTORY_LENGTH
      - key: RAG_TEMPERATURE
        value: $RAG_TEMPERATURE
      - key: RAG_MAX_TOKENS
        value: $RAG_MAX_TOKENS
      - key: RAG_TOP_K
        value: $RAG_TOP_K